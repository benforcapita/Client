{"ast":null,"code":"\"use strict\";\n\nconst DOMException = require(\"domexception\");\n\nconst idlUtils = require(\"../generated/utils\");\n\nconst conversions = require(\"webidl-conversions\"); // TODO: Once NodeFilter is ported to IDL method, use those instead.\n\n\nexports.FILTER_ACCEPT = 1; // NodeFilter.FILTER_ACCEPT\n\nexports.FILTER_REJECT = 2; // NodeFilter.FILTER_REJECT\n\nexports.FILTER_SKIP = 3; // NodeFilter.FILTER_SKIP\n\nexports.filter = (nodeIteratorOrTreeWalkerImpl, nodeImpl) => {\n  if (nodeIteratorOrTreeWalkerImpl._active) {\n    throw new DOMException(\"Recursive node filtering\", \"InvalidStateError\");\n  }\n\n  const n = nodeImpl.nodeType - 1;\n\n  if (!(1 << n & nodeIteratorOrTreeWalkerImpl.whatToShow)) {\n    return exports.FILTER_SKIP;\n  } // Saving in a variable is important so we don't accidentally call it as a method later.\n\n\n  const filter = nodeIteratorOrTreeWalkerImpl.filter;\n\n  if (filter === null) {\n    return exports.FILTER_ACCEPT;\n  }\n\n  nodeIteratorOrTreeWalkerImpl._active = true;\n  let result; // https://github.com/whatwg/dom/issues/494\n\n  try {\n    if (typeof filter === \"function\") {\n      result = filter(idlUtils.wrapperForImpl(nodeImpl));\n    } else {\n      result = filter.acceptNode(idlUtils.wrapperForImpl(nodeImpl));\n    }\n  } finally {\n    nodeIteratorOrTreeWalkerImpl._active = false;\n  }\n\n  result = conversions[\"unsigned short\"](result);\n  return result;\n};","map":null,"metadata":{},"sourceType":"script"}